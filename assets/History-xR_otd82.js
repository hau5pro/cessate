var b=Object.defineProperty;var g=(e,n,s)=>n in e?b(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var _=(e,n,s)=>g(e,typeof n!="symbol"?n+"":n,s);import{j as t,B as a,e as l,x as v,r as f}from"./mui-MagnalEl.js";import{p as E,d as h,t as u,h as N,f as A,L as H,m as D}from"./index-4H7UTGN2.js";import"./firebase-CZ1iWosV.js";class j{static isStale(n){return Date.now()-n>E.ONE_DAY_IN_MS}static debounce(n,s){let o=null;return(...i)=>{o&&clearTimeout(o),o=setTimeout(()=>n(...i),s)}}}_(j,"DEBOUNCE_DELAY",300);const L="_Card_nzpst_1",M="_Section_nzpst_14",T="_CenterText_nzpst_28",y={Card:L,Section:M,CenterText:T};function z({session:e}){var r;const n=e.createdAt.toDate(),s=e.endedAt?(r=e.endedAt)==null?void 0:r.toDate():null,o=h(n).format("MMM D, YYYY"),i=h(n).format("h:mm A"),m=e.duration,c=e.percentage,d=e.color??u.palette.secondary.main;return t.jsxs(a,{className:y.Card,children:[t.jsxs(a,{className:y.Section,children:[t.jsx(l,{className:y.CenterText,variant:"body1",color:u.palette.secondary.main,children:o}),t.jsx(l,{variant:"subtitle2",color:u.palette.secondary.main,children:i})]}),t.jsxs(a,{className:y.Section,children:[c!==null?t.jsxs(a,{className:y.Section,children:[t.jsx(l,{variant:"body2",sx:{fontSize:14},color:d,children:`${c}%`}),t.jsx(v,{variant:"determinate",value:c,sx:{width:"100px",borderRadius:4,backgroundColor:"rgba(0, 0, 0, 0.1)",height:4,"& .MuiLinearProgress-bar":{backgroundColor:d}}})]}):t.jsx(a,{}),t.jsx(l,{variant:"body2",sx:{fontSize:14},color:u.palette.primary.main,children:s?`Lasted ${h.duration(m||0,"seconds").humanize()}`:"Session in progress"})]})]})}const Y="_HistoryContainer_134cw_1",w="_HistoryContent_134cw_10",O="_EmptyState_134cw_18",C={HistoryContainer:Y,HistoryContent:w,EmptyState:O},B={hidden:{opacity:0,y:-20,scale:.95},visible:e=>({y:0,opacity:1,scale:1,transition:{delay:e*.05,duration:.3,ease:"easeOut"}})},I=({children:e,index:n,className:s})=>t.jsx(D.div,{className:s,variants:B,initial:"hidden",animate:"visible",custom:n,children:e});function V(){const{sessions:e,hasInitialized:n,hasMore:s,loading:o,loadMore:i}=N(),m=A(r=>r.user),c=f.useRef(null),d=n&&e.length===0;return f.useEffect(()=>{if(!m||!s||o)return;const r=j.debounce(()=>{i(m.uid)},j.DEBOUNCE_DELAY),x=new IntersectionObserver(S=>{S[0].isIntersecting&&r()}),p=c.current;return p&&x.observe(p),()=>{p&&x.unobserve(p)}},[m,s,o,i]),t.jsx(a,{className:C.HistoryContainer,children:t.jsxs(a,{className:C.HistoryContent,children:[d&&t.jsx(R,{}),!d&&e.map((r,x)=>t.jsx(I,{index:x,children:t.jsx(z,{session:r})},r.id)),s&&t.jsx("div",{ref:c,style:{height:1}}),o&&!d&&t.jsx(H,{})]})})}function R(){return t.jsxs(a,{className:C.EmptyState,children:[t.jsx(l,{variant:"h5",color:u.palette.secondary.main,sx:{mt:4,textAlign:"center"},children:"No past sessions yet."}),t.jsx(l,{variant:"body2",color:u.palette.secondary.main,sx:{mt:1,textAlign:"center",opacity:.7},children:"Start a session to begin your journey."})]})}export{V as default};
