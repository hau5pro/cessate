import{r as h,j as a,B as k,m as it,g as rt,e as T,D as at}from"./mui-VNDw4GbL.js";import{C as Q,u as E,d as H,t as ut,a as U,b as X,L as ct,r as Z,l as lt,s as dt}from"./index-DfbA14Yv.js";import{M as ht,u as J,P as ft,a as mt,b as tt,L as pt,c as yt,s as et,m as I}from"./proxy-T6__QUVo.js";import{B as st}from"./BaseButton-BAn9bG3A.js";import"./firebase-D7NFCWFF.js";class gt extends h.Component{getSnapshotBeforeUpdate(r){const o=this.props.childRef.current;if(o&&r.isPresent&&!this.props.isPresent){const n=o.offsetParent,l=n instanceof HTMLElement&&n.offsetWidth||0,i=this.props.sizeRef.current;i.height=o.offsetHeight||0,i.width=o.offsetWidth||0,i.top=o.offsetTop,i.left=o.offsetLeft,i.right=l-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function xt({children:e,isPresent:r,anchorX:o}){const n=h.useId(),l=h.useRef(null),i=h.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=h.useContext(ht);return h.useInsertionEffect(()=>{const{width:x,height:u,top:m,left:p,right:$}=i.current;if(r||!l.current||!x||!u)return;const C=o==="left"?`left: ${p}`:`right: ${$}`;l.current.dataset.motionPopId=n;const v=document.createElement("style");return f&&(v.nonce=f),document.head.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${u}px !important;
            ${C}px !important;
            top: ${m}px !important;
          }
        `),()=>{document.head.contains(v)&&document.head.removeChild(v)}},[r]),a.jsx(gt,{isPresent:r,childRef:l,sizeRef:i,children:h.cloneElement(e,{ref:l})})}const vt=({children:e,initial:r,isPresent:o,onExitComplete:n,custom:l,presenceAffectsLayout:i,mode:f,anchorX:x})=>{const u=J($t),m=h.useId();let p=!0,$=h.useMemo(()=>(p=!1,{id:m,initial:r,isPresent:o,custom:l,onExitComplete:C=>{u.set(C,!0);for(const v of u.values())if(!v)return;n&&n()},register:C=>(u.set(C,!1),()=>u.delete(C))}),[o,u,n]);return i&&p&&($={...$}),h.useMemo(()=>{u.forEach((C,v)=>u.set(v,!1))},[o]),h.useEffect(()=>{!o&&!u.size&&n&&n()},[o]),f==="popLayout"&&(e=a.jsx(xt,{isPresent:o,anchorX:x,children:e})),a.jsx(ft.Provider,{value:$,children:e})};function $t(){return new Map}const A=e=>e.key||"";function W(e){const r=[];return h.Children.forEach(e,o=>{h.isValidElement(o)&&r.push(o)}),r}const Ct=({children:e,custom:r,initial:o=!0,onExitComplete:n,presenceAffectsLayout:l=!0,mode:i="sync",propagate:f=!1,anchorX:x="left"})=>{const[u,m]=mt(f),p=h.useMemo(()=>W(e),[e]),$=f&&!u?[]:p.map(A),C=h.useRef(!0),v=h.useRef(p),M=J(()=>new Map),[P,L]=h.useState(p),[w,z]=h.useState(p);tt(()=>{C.current=!1,v.current=p;for(let S=0;S<w.length;S++){const c=A(w[S]);$.includes(c)?M.delete(c):M.get(c)!==!0&&M.set(c,!1)}},[w,$.length,$.join("-")]);const D=[];if(p!==P){let S=[...p];for(let c=0;c<w.length;c++){const s=w[c],t=A(s);$.includes(t)||(S.splice(c,0,s),D.push(s))}return i==="wait"&&D.length&&(S=D),z(W(S)),L(p),null}const{forceRender:Y}=h.useContext(pt);return a.jsx(a.Fragment,{children:w.map(S=>{const c=A(S),s=f&&!u?!1:p===w||$.includes(c),t=()=>{if(M.has(c))M.set(c,!0);else return;let d=!0;M.forEach(y=>{y||(d=!1)}),d&&(Y==null||Y(),z(v.current),f&&(m==null||m()),n&&n())};return a.jsx(vt,{isPresent:s,initial:!C.current||o?void 0:!1,custom:r,presenceAffectsLayout:l,mode:i,onExitComplete:s?void 0:t,anchorX:x,children:S},c)})})};function wt(e){e.values.forEach(r=>r.stop())}function V(e,r){[...r].reverse().forEach(n=>{const l=e.getVariant(n);l&&et(e,l),e.variantChildren&&e.variantChildren.forEach(i=>{V(i,r)})})}function bt(e,r){if(Array.isArray(r))return V(e,r);if(typeof r=="string")return V(e,[r]);et(e,r)}function St(){const e=new Set,r={subscribe(o){return e.add(o),()=>void e.delete(o)},start(o,n){const l=[];return e.forEach(i=>{l.push(yt(i,o,{transitionOverride:n}))}),Promise.all(l)},set(o){return e.forEach(n=>{bt(n,o)})},stop(){e.forEach(o=>{wt(o)})},mount(){return()=>{r.stop()}}};return r}function jt(){const e=J(St);return tt(e.mount,[]),e}const N=jt,Mt=it`
  0% {
    transform: translateX(-100%);
    opacity: 0;
  }
  25% {
    opacity: 1;
  }
  75% {
    opacity: 1;
  }
  100% {
    transform: translateX(100%);
    opacity: 0;
  }
`,kt=({percent:e,width:r="100%",animate:o=!1,sx:n,...l})=>a.jsx(k,{sx:{position:"relative",width:r,height:5,borderRadius:5,overflow:"hidden",backgroundColor:"rgba(255,255,255,0.1)",...n},...l,children:a.jsx(k,{sx:{width:`${e}%`,height:"100%",backgroundColor:Q.interpolateColor(e/100),borderRadius:5,transition:"width 0.5s ease, background-color 0.3s ease",position:"relative",overflow:"hidden",...o&&e!==100&&{"&::after":{content:'""',position:"absolute",top:0,left:"-100%",width:"200%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent)",animation:`${Mt} 2.5s ease-in-out infinite`,pointerEvents:"none"}}}})});var B={exports:{}},Dt=B.exports,G;function Rt(){return G||(G=1,function(e,r){(function(o,n){e.exports=n()})(Dt,function(){var o,n,l=1e3,i=6e4,f=36e5,x=864e5,u=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=31536e6,p=2628e6,$=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,C={years:m,months:p,days:x,hours:f,minutes:i,seconds:l,milliseconds:1,weeks:6048e5},v=function(c){return c instanceof Y},M=function(c,s,t){return new Y(c,t,s.$l)},P=function(c){return n.p(c)+"s"},L=function(c){return c<0},w=function(c){return L(c)?Math.ceil(c):Math.floor(c)},z=function(c){return Math.abs(c)},D=function(c,s){return c?L(c)?{negative:!0,format:""+z(c)+s}:{negative:!1,format:""+c+s}:{negative:!1,format:""}},Y=function(){function c(t,d,y){var g=this;if(this.$d={},this.$l=y,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),d)return M(t*C[P(d)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(R){g.$d[P(R)]=t[R]}),this.calMilliseconds(),this;if(typeof t=="string"){var b=t.match($);if(b){var j=b.slice(2).map(function(R){return R!=null?Number(R):0});return this.$d.years=j[0],this.$d.months=j[1],this.$d.weeks=j[2],this.$d.days=j[3],this.$d.hours=j[4],this.$d.minutes=j[5],this.$d.seconds=j[6],this.calMilliseconds(),this}}return this}var s=c.prototype;return s.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(d,y){return d+(t.$d[y]||0)*C[y]},0)},s.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=w(t/m),t%=m,this.$d.months=w(t/p),t%=p,this.$d.days=w(t/x),t%=x,this.$d.hours=w(t/f),t%=f,this.$d.minutes=w(t/i),t%=i,this.$d.seconds=w(t/l),t%=l,this.$d.milliseconds=t},s.toISOString=function(){var t=D(this.$d.years,"Y"),d=D(this.$d.months,"M"),y=+this.$d.days||0;this.$d.weeks&&(y+=7*this.$d.weeks);var g=D(y,"D"),b=D(this.$d.hours,"H"),j=D(this.$d.minutes,"M"),R=this.$d.seconds||0;this.$d.milliseconds&&(R+=this.$d.milliseconds/1e3,R=Math.round(1e3*R)/1e3);var _=D(R,"S"),nt=t.negative||d.negative||g.negative||b.negative||j.negative||_.negative,ot=b.format||j.format||_.format?"T":"",F=(nt?"-":"")+"P"+t.format+d.format+g.format+ot+b.format+j.format+_.format;return F==="P"||F==="-P"?"P0D":F},s.toJSON=function(){return this.toISOString()},s.format=function(t){var d=t||"YYYY-MM-DDTHH:mm:ss",y={Y:this.$d.years,YY:n.s(this.$d.years,2,"0"),YYYY:n.s(this.$d.years,4,"0"),M:this.$d.months,MM:n.s(this.$d.months,2,"0"),D:this.$d.days,DD:n.s(this.$d.days,2,"0"),H:this.$d.hours,HH:n.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:n.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:n.s(this.$d.seconds,2,"0"),SSS:n.s(this.$d.milliseconds,3,"0")};return d.replace(u,function(g,b){return b||String(y[g])})},s.as=function(t){return this.$ms/C[P(t)]},s.get=function(t){var d=this.$ms,y=P(t);return y==="milliseconds"?d%=1e3:d=y==="weeks"?w(d/C[y]):this.$d[y],d||0},s.add=function(t,d,y){var g;return g=d?t*C[P(d)]:v(t)?t.$ms:M(t,this).$ms,M(this.$ms+g*(y?-1:1),this)},s.subtract=function(t,d){return this.add(t,d,!0)},s.locale=function(t){var d=this.clone();return d.$l=t,d},s.clone=function(){return M(this.$ms,this)},s.humanize=function(t){return o().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},s.valueOf=function(){return this.asMilliseconds()},s.milliseconds=function(){return this.get("milliseconds")},s.asMilliseconds=function(){return this.as("milliseconds")},s.seconds=function(){return this.get("seconds")},s.asSeconds=function(){return this.as("seconds")},s.minutes=function(){return this.get("minutes")},s.asMinutes=function(){return this.as("minutes")},s.hours=function(){return this.get("hours")},s.asHours=function(){return this.as("hours")},s.days=function(){return this.get("days")},s.asDays=function(){return this.as("days")},s.weeks=function(){return this.get("weeks")},s.asWeeks=function(){return this.as("weeks")},s.months=function(){return this.get("months")},s.asMonths=function(){return this.as("months")},s.years=function(){return this.get("years")},s.asYears=function(){return this.as("years")},c}(),S=function(c,s,t){return c.add(s.years()*t,"y").add(s.months()*t,"M").add(s.days()*t,"d").add(s.hours()*t,"h").add(s.minutes()*t,"m").add(s.seconds()*t,"s").add(s.milliseconds()*t,"ms")};return function(c,s,t){o=t,n=t().$utils(),t.duration=function(g,b){var j=t.locale();return M(g,{$l:j},b)},t.isDuration=v;var d=s.prototype.add,y=s.prototype.subtract;s.prototype.add=function(g,b){return v(g)?S(this,g,1):d.bind(this)(g,b)},s.prototype.subtract=function(g,b){return v(g)?S(this,g,-1):y.bind(this)(g,b)}}})}(B)),B.exports}var Et=Rt();const Pt=rt(Et);H.extend(Pt);const Tt={hidden:{opacity:0,y:-20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}},exit:{opacity:0,y:-20,transition:{duration:.3}}};function Yt(){const e=E($=>$.currentSession),[r,o]=h.useState(H());if(h.useEffect(()=>{const $=setInterval(()=>o(H()),1e3);return()=>clearInterval($)},[]),!e||!e.createdAt)return null;const n=e.createdAt.toDate(),l=H(n).add(e.targetDuration,"second"),i=H.duration(Math.max(l.diff(r),0)),f=H.duration(Math.max(r.diff(n),0)),x=f.asSeconds(),u=e.targetDuration,m=u>0?Math.min(100,Math.max(0,x/u*100)):0,p=m/100;return a.jsx(Ct,{children:a.jsx(I.div,{initial:"hidden",animate:"visible",exit:"exit",variants:Tt,children:a.jsxs(k,{textAlign:"center",p:1,sx:{display:"flex",flexDirection:"column",justifyContent:"center",gap:.5,flexGrow:1},children:[a.jsx(T,{variant:"h3",color:"secondary",mt:1,children:"You've abstained for"}),a.jsxs(T,{variant:"h2",color:ut.palette.common.white,sx:{fontSize:"3rem"},children:[f.days(),"d ",f.hours(),"h ",f.minutes(),"m"]}),a.jsx(T,{variant:"body1",color:"secondary",mt:2,children:"Time remaining"}),a.jsx(T,{variant:"subtitle1",children:i.format("HH:mm:ss")}),a.jsxs(k,{textAlign:"center",p:2,sx:{display:"flex",flexDirection:"column",gap:1},children:[a.jsx(kt,{percent:m,width:"60%",animate:!0,sx:{alignSelf:"center"}}),a.jsxs(T,{variant:"body2",display:"block",mt:1,children:[a.jsxs("span",{style:{color:Q.interpolateColor(p)},children:[Math.floor(m),"%"]})," ","of your target completed",i.asSeconds()===0?"!":""]})]})]})},"current-session")})}const q=[{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"It always seems impossible until it’s done.",author:"Nelson Mandela"},{text:"You are never too old to set another goal or to dream a new dream.",author:"C.S. Lewis"},{text:"The greatest wealth is health.",author:"Virgil"},{text:"Your life does not get better by chance, it gets better by change.",author:"Jim Rohn"},{text:"Health is not valued till sickness comes.",author:"Thomas Fuller"},{text:"Don’t let yesterday take up too much of today.",author:"Will Rogers"},{text:"It is health that is real wealth and not pieces of gold and silver.",author:"Mahatma Gandhi"},{text:"Take care of your body. It’s the only place you have to live.",author:"Jim Rohn"},{text:"Courage is resistance to fear, mastery of fear – not absence of fear.",author:"Mark Twain"},{text:"The only way to achieve the impossible is to believe it is possible.",author:"Charles Kingsleigh"},{text:"Fall seven times, stand up eight.",author:"Japanese Proverb"},{text:"Strength does not come from physical capacity. It comes from an indomitable will.",author:"Mahatma Gandhi"},{text:"The first step towards getting somewhere is to decide you’re not going to stay where you are.",author:"J.P. Morgan"},{text:"The journey of a thousand miles begins with one step.",author:"Lao Tzu"},{text:"Success is not final, failure is not fatal: it is the courage to continue that counts.",author:"Winston Churchill"},{text:"Believe you can, and you’re halfway there.",author:"Theodore Roosevelt"},{text:"You don’t have to see the whole staircase. Just take the first step.",author:"Martin Luther King"},{text:"If you do what you’ve always done, you’ll get what you’ve always gotten.",author:"Tony Robbins"},{text:"It doesn’t matter how slowly you go, only that you do not stop.",author:"Confucius"},{text:"If we are facing in the right direction, all we have to do is keep on walking.",author:"Zen Proverb"},{text:"It does not matter how slowly you go as long as you do not stop.",author:"Confucius"}],K=()=>q[Math.floor(Math.random()*q.length)],Ht=({controls:e})=>{const[r,o]=h.useState(K());h.useEffect(()=>{o(K())},[]);const n=r.text.split(" ");return a.jsxs(k,{textAlign:"center",sx:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,padding:2},children:[a.jsx(T,{variant:"h3",gutterBottom:!0,children:a.jsx(k,{component:"span",display:"inline-block",children:n.map((l,i)=>a.jsx(I.span,{initial:{opacity:0,y:10},animate:e,transition:{delay:i*.15},style:{display:"inline-block",marginRight:"6px"},children:l},i))})}),a.jsx(I.div,{initial:{opacity:0},animate:e,transition:{delay:n.length*.15+.5},children:a.jsxs(T,{variant:"body1",color:"textSecondary",mt:1,children:["— ",r.author]})})]})};function It(){const e=U(u=>u.user),r=E(u=>u.currentSession),o=E(u=>u.setCurrentSession),n=E(u=>u.loading),l=E(u=>u.setLoading),i=X(u=>{var m;return(m=u.settings)==null?void 0:m.targetDuration}),f=async()=>{if(!(!e||!(r!=null&&r.id)||!i))try{l(!0);const u=await Z(async m=>lt(e.uid,r,i,m));o(u)}catch(u){console.error("Relapse failed:",u)}finally{l(!1)}},x="0.3em";return a.jsxs(st,{sx:{minHeight:"56px",position:"relative"},color:"secondary",onClick:f,disabled:n,children:[a.jsx(k,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:a.jsxs("span",{style:{fontFamily:"Roboto, sans-serif",letterSpacing:x,display:"inline-block"},children:["R",a.jsx("span",{style:{transform:"rotateY(180deg)",display:"inline-block",margin:`0 ${x} 0 -${x}`},children:"e"}),"lapse"]})}),a.jsx(k,{sx:{position:"absolute",right:24,top:"50%",transform:"translateY(-50%)",opacity:n?1:0,transition:"opacity 0.2s ease",pointerEvents:"none"},children:a.jsx(ct,{size:30})})]})}function Lt(){const e=U(i=>i.user),r=X(i=>i.settings),o=E(i=>i.setCurrentSession),n=E(i=>i.setLoading),l=async()=>{if(!(!e||!(r!=null&&r.targetDuration)))try{n(!0);const i=await Z(async f=>dt(e.uid,r.targetDuration,f));o({...i})}catch(i){console.error("Failed to start session:",i)}finally{n(!1)}};return a.jsx(st,{variant:"contained",color:"primary",onClick:l,children:"Start Your Journey"})}const zt="_HomeContainer_az91x_1",At="_ScrollContainer_az91x_10",Bt="_ButtonContainer_az91x_20",O={HomeContainer:zt,ScrollContainer:At,ButtonContainer:Bt};function Jt(){const e=E(u=>u.currentSession),r=E(u=>u.loading),o=E(u=>u.hasInitialized),n=N(),l=N(),i=N(),[f,x]=h.useState(!1);return h.useEffect(()=>{o&&x(!0)},[o]),h.useEffect(()=>{f&&(n.start({y:0,opacity:1}),setTimeout(()=>{l.start({y:0,opacity:1})},200),setTimeout(()=>{i.start({opacity:1})},1e3))},[f,n,l,i]),o?a.jsxs(k,{className:O.HomeContainer,children:[a.jsxs(k,{className:O.ScrollContainer,children:[a.jsx(I.div,{initial:{y:-20,opacity:0},animate:n,transition:{duration:.5,ease:"easeOut"},children:a.jsx(Yt,{})}),a.jsx(at,{}),a.jsx(Ht,{controls:i})]}),a.jsx(k,{className:O.ButtonContainer,children:a.jsx(I.div,{initial:{y:40,opacity:0},animate:l,transition:{duration:.5,ease:"easeOut"},style:{width:"100%"},children:!r&&!e?a.jsx(Lt,{}):a.jsx(It,{})})})]}):null}export{Jt as default};
