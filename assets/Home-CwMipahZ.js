import{j as e,B as u,m as V,r as f,e as p,D as Y}from"./mui-MagnalEl.js";import{a as J,s as D,u as N,b as F,C as I,c as d,d as x,A as K,m as w,t as Q,e as $,g as q,f as H,h as M,i as b,j as T,L as O,r as B,l as U,k as W}from"./index-w7FQEbni.js";import{B as L}from"./BaseButton-eIzhkely.js";import{T as X}from"./firebase-CZ1iWosV.js";function Z(t){t.values.forEach(o=>o.stop())}function k(t,o){[...o].reverse().forEach(r=>{const i=t.getVariant(r);i&&D(t,i),t.variantChildren&&t.variantChildren.forEach(l=>{k(l,o)})})}function tt(t,o){if(Array.isArray(o))return k(t,o);if(typeof o=="string")return k(t,[o]);D(t,o)}function et(){const t=new Set,o={subscribe(a){return t.add(a),()=>void t.delete(a)},start(a,r){const i=[];return t.forEach(l=>{i.push(J(l,a,{transitionOverride:r}))}),Promise.all(i)},set(a){return t.forEach(r=>{tt(r,a)})},stop(){t.forEach(a=>{Z(a)})},mount(){return()=>{o.stop()}}};return o}function ot(){const t=N(et);return F(t.mount,[]),t}const j=ot,st=V`
  0% {
    transform: translateX(-100%);
    opacity: 0;
  }
  25% {
    opacity: 1;
  }
  75% {
    opacity: 1;
  }
  100% {
    transform: translateX(100%);
    opacity: 0;
  }
`,nt=({percent:t,width:o="100%",animate:a=!1,sx:r,...i})=>e.jsx(u,{sx:{position:"relative",width:o,height:5,borderRadius:5,overflow:"hidden",backgroundColor:"rgba(255,255,255,0.1)",...r},...i,children:e.jsx(u,{sx:{width:`${t}%`,height:"100%",backgroundColor:I.interpolateColor(t/100),borderRadius:5,transition:"width 0.5s ease, background-color 0.3s ease",position:"relative",overflow:"hidden",...a&&t!==100&&{"&::after":{content:'""',position:"absolute",top:0,left:"-100%",width:"200%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent)",animation:`${st} 2.5s ease-in-out infinite`,pointerEvents:"none"}}}})});x.extend($);const at={hidden:{opacity:0,y:-20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}},exit:{opacity:0,y:-20,transition:{duration:.3}}};function rt(){const t=d(S=>S.currentSession),[o,a]=f.useState(x());if(f.useEffect(()=>{const S=setInterval(()=>a(x()),1e3);return()=>clearInterval(S)},[]),!t||!t.createdAt)return null;const r=t.createdAt.toDate(),i=x(r).add(t.targetDuration,"second"),l=x.duration(Math.max(i.diff(o),0)),n=x.duration(Math.max(o.diff(r),0)),m=n.asSeconds(),c=t.targetDuration,h=c>0?Math.min(100,Math.max(0,m/c*100)):0,g=h/100;return e.jsx(K,{children:e.jsx(w.div,{initial:"hidden",animate:"visible",exit:"exit",variants:at,children:e.jsxs(u,{textAlign:"center",p:1,sx:{display:"flex",flexDirection:"column",justifyContent:"center",gap:.5,flexGrow:1},children:[e.jsx(p,{variant:"h3",color:"secondary",mt:1,children:"You've abstained for"}),e.jsxs(p,{variant:"h2",color:Q.palette.common.white,sx:{fontSize:"3rem"},children:[n.days(),"d ",n.hours(),"h ",n.minutes(),"m"]}),e.jsx(p,{variant:"body1",color:"secondary",mt:2,children:"Time remaining"}),e.jsx(p,{variant:"subtitle1",children:l.format("HH:mm:ss")}),e.jsxs(u,{textAlign:"center",p:2,sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(nt,{percent:h,width:"60%",animate:!0,sx:{alignSelf:"center"}}),e.jsxs(p,{variant:"body2",display:"block",mt:1,children:[e.jsxs("span",{style:{color:I.interpolateColor(g)},children:[Math.floor(h),"%"]})," ","of your target completed",l.asSeconds()===0?"!":""]})]})]})},"current-session")})}const A=[{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"It always seems impossible until it’s done.",author:"Nelson Mandela"},{text:"You are never too old to set another goal or to dream a new dream.",author:"C.S. Lewis"},{text:"The greatest wealth is health.",author:"Virgil"},{text:"Your life does not get better by chance, it gets better by change.",author:"Jim Rohn"},{text:"Health is not valued till sickness comes.",author:"Thomas Fuller"},{text:"Don’t let yesterday take up too much of today.",author:"Will Rogers"},{text:"It is health that is real wealth and not pieces of gold and silver.",author:"Mahatma Gandhi"},{text:"Take care of your body. It’s the only place you have to live.",author:"Jim Rohn"},{text:"Courage is resistance to fear, mastery of fear – not absence of fear.",author:"Mark Twain"},{text:"The only way to achieve the impossible is to believe it is possible.",author:"Charles Kingsleigh"},{text:"Fall seven times, stand up eight.",author:"Japanese Proverb"},{text:"Strength does not come from physical capacity. It comes from an indomitable will.",author:"Mahatma Gandhi"},{text:"The first step towards getting somewhere is to decide you’re not going to stay where you are.",author:"J.P. Morgan"},{text:"The journey of a thousand miles begins with one step.",author:"Lao Tzu"},{text:"Success is not final, failure is not fatal: it is the courage to continue that counts.",author:"Winston Churchill"},{text:"Believe you can, and you’re halfway there.",author:"Theodore Roosevelt"},{text:"You don’t have to see the whole staircase. Just take the first step.",author:"Martin Luther King"},{text:"If you do what you’ve always done, you’ll get what you’ve always gotten.",author:"Tony Robbins"},{text:"It doesn’t matter how slowly you go, only that you do not stop.",author:"Confucius"},{text:"If we are facing in the right direction, all we have to do is keep on walking.",author:"Zen Proverb"},{text:"It does not matter how slowly you go as long as you do not stop.",author:"Confucius"}],R=()=>A[Math.floor(Math.random()*A.length)],it=({controls:t})=>{const[o,a]=f.useState(R());f.useEffect(()=>{a(R())},[]);const r=o.text.split(" ");return e.jsxs(u,{textAlign:"center",sx:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,padding:2},children:[e.jsx(p,{variant:"h3",gutterBottom:!0,children:e.jsx(u,{component:"span",display:"inline-block",children:r.map((i,l)=>e.jsx(w.span,{initial:{opacity:0,y:10},animate:t,transition:{delay:l*.15},style:{display:"inline-block",marginRight:"6px"},children:i},l))})}),e.jsx(w.div,{initial:{opacity:0},animate:t,transition:{delay:r.length*.15+.5},children:e.jsxs(p,{variant:"body1",color:"textSecondary",mt:1,children:["— ",o.author]})})]})};function lt(){const t=q(),o=H(s=>s.user),a=M(s=>{var y;return(y=s.settings)==null?void 0:y.targetDuration}),r=d(s=>s.currentSession),i=d(s=>s.setCurrentSession),l=d(s=>s.loading),n=d(s=>s.setLoading),m=b(s=>s.sessionGaps.data.find(y=>y.day===t)),c=b(s=>s.updateTodaySessionGapSummary),h=b(s=>s.dailySessions.data.find(y=>y.day===t)),g=b(s=>s.updateTodayDailySession),S=T(s=>s.updateSession),E=T(s=>s.addSession),z=async()=>{if(!(!o||!(r!=null&&r.id)||!a))try{n(!0);const{session:s,previous:y,gapSummary:P}=await B(async G=>U(o.uid,r,a,G,m));c(P);const _=((h==null?void 0:h.count)??0)+1;g({day:t,count:_,updatedAt:X.now()}),S(y),E(s),i(s)}catch(s){console.error("Relapse failed:",s)}finally{n(!1)}},v="0.3em";return e.jsxs(L,{sx:{minHeight:"56px",position:"relative"},color:"secondary",onClick:z,disabled:l,children:[e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:e.jsxs("span",{style:{fontFamily:"Roboto, sans-serif",letterSpacing:v,display:"inline-block"},children:["R",e.jsx("span",{style:{transform:"rotateY(180deg)",display:"inline-block",margin:`0 ${v} 0 -${v}`},children:"e"}),"lapse"]})}),e.jsx(u,{sx:{position:"absolute",right:24,top:"50%",transform:"translateY(-50%)",opacity:l?1:0,transition:"opacity 0.2s ease",pointerEvents:"none"},children:e.jsx(O,{size:30})})]})}function ct(){const t=H(n=>n.user),o=M(n=>n.settings),a=d(n=>n.setCurrentSession),r=d(n=>n.setLoading),i=T(n=>n.addSession),l=async()=>{if(!(!t||!(o!=null&&o.targetDuration)))try{r(!0);const n=await B(async m=>W(t.uid,o.targetDuration,m));a({...n}),i(n)}catch(n){console.error("Failed to start session:",n)}finally{r(!1)}};return e.jsx(L,{variant:"contained",color:"primary",onClick:l,children:"Start Your Journey"})}const ut="_HomeContainer_az91x_1",dt="_ScrollContainer_az91x_10",ht="_ButtonContainer_az91x_20",C={HomeContainer:ut,ScrollContainer:dt,ButtonContainer:ht};function xt(){const t=d(c=>c.currentSession),o=d(c=>c.loading),a=d(c=>c.hasInitialized),r=j(),i=j(),l=j(),[n,m]=f.useState(!1);return f.useEffect(()=>{a&&m(!0)},[a]),f.useEffect(()=>{let c=!0;if(!n)return;const h=()=>{c&&(r.start({y:0,opacity:1}),setTimeout(()=>{c&&i.start({y:0,opacity:1})},200),setTimeout(()=>{c&&l.start({opacity:1})},1e3))},g=setTimeout(()=>{requestAnimationFrame(h)},0);return()=>{c=!1,clearTimeout(g)}},[n]),a?e.jsxs(u,{className:C.HomeContainer,children:[e.jsxs(u,{className:C.ScrollContainer,children:[e.jsx(w.div,{initial:{y:-20,opacity:0},animate:r,transition:{duration:.5,ease:"easeOut"},children:e.jsx(rt,{})}),e.jsx(Y,{}),e.jsx(it,{controls:l})]}),e.jsx(u,{className:C.ButtonContainer,children:e.jsx(w.div,{initial:{y:40,opacity:0},animate:i,transition:{duration:.5,ease:"easeOut"},style:{width:"100%"},children:!o&&!t?e.jsx(ct,{}):e.jsx(lt,{})})})]}):null}export{xt as default};
